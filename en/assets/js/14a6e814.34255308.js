"use strict";(self.webpackChunkrealsee_developer_github_com=self.webpackChunkrealsee_developer_github_com||[]).push([[7336],{49613:(e,n,r)=>{r.d(n,{Zo:()=>m,kt:()=>u});var t=r(59496);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function o(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=t.createContext({}),l=function(e){var n=t.useContext(p),r=n;return e&&(r="function"==typeof e?e(n):o(o({},n),e)),r},m=function(e){var n=l(e.components);return t.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=l(r),u=a,v=d["".concat(p,".").concat(u)]||d[u]||c[u]||i;return r?t.createElement(v,o(o({ref:n},m),{},{components:r})):t.createElement(v,o({ref:n},m))}));function u(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=d;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=r[l];return t.createElement.apply(null,o)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},22841:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var t=r(2962),a=(r(59496),r(49613));const i={title:"WeChat Miniprogram"},o=void 0,s={unversionedId:"webview/miniProgram/wechat",id:"webview/miniProgram/wechat",title:"WeChat Miniprogram",description:"::tip hint",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/webview/miniProgram/wechat.md",sourceDirName:"webview/miniProgram",slug:"/webview/miniProgram/wechat",permalink:"/en/docs/webview/miniProgram/wechat",draft:!1,tags:[],version:"current",lastUpdatedBy:"lichengjie",lastUpdatedAt:1669264964,formattedLastUpdatedAt:"Nov 24, 2022",frontMatter:{title:"WeChat Miniprogram"},sidebar:"\u5bb9\u5668\u96c6\u6210",previous:{title:"Android",permalink:"/en/docs/webview/app/Android"},next:{title:"@realsee/jsbridge-x",permalink:"/en/docs/webview/jsbridge/intro"}},p={},l=[{value:"Environmental requirements",id:"environmental-requirements",level:2},{value:"Terminal Requirements",id:"terminal-requirements",level:3},{value:"View Function Limit Requirement (no access for negligible)",id:"view-function-limit-requirement-no-access-for-negligible",level:3},{value:"Development preparation",id:"development-preparation",level:2},{value:"Apply SDK access key",id:"apply-sdk-access-key",level:3},{value:"Add widget&#39;s valid domain whitelist",id:"add-widgets-valid-domain-whitelist",level:3},{value:"SDK Downloads",id:"sdk-downloads",level:3},{value:"SDK Usage",id:"sdk-usage",level:3},{value:"Miniprogram native development usage",id:"miniprogram-native-development-usage",level:4},{value:"Taro 3 Framework Access",id:"taro-3-framework-access",level:4},{value:"uni-app access",id:"uni-app-access",level:4}],m={toc:l};function c(e){let{components:n,...r}=e;return(0,a.kt)("wrapper",(0,t.Z)({},m,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"::tip hint",(0,a.kt)("br",{parentName:"p"}),"\n","This document is in front of ",(0,a.kt)("strong",{parentName:"p"},"Miniprogram Developer"),", in the description that follows, we assume you already have development experience of front end, micromessenger applet, etc. and have installed related micromessenger app.\n:::"),(0,a.kt)("h2",{id:"environmental-requirements"},"Environmental requirements"),(0,a.kt)("h3",{id:"terminal-requirements"},"Terminal Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"IOS Wechat App Version Requirements\uff1a7.0.9."),(0,a.kt)("li",{parentName:"ul"},"Android Wechat App minimum request\uff1a7.0.8."),(0,a.kt)("li",{parentName:"ul"},"The micromessage PC applet (windows/macOS) app."),(0,a.kt)("li",{parentName:"ul"},"Minimum version requirement for the base library\uff1a2.10.0.")),(0,a.kt)("h3",{id:"view-function-limit-requirement-no-access-for-negligible"},"View Function Limit Requirement (no access for negligible)"),(0,a.kt)("admonition",{title:"warning",type:"warning"},(0,a.kt)("p",{parentName:"admonition"},"If you use a watched capability, make sure all of the following requirements are met when developing tests :")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Only",(0,a.kt)("strong",{parentName:"p"},"micromessaging applets are supported"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Since the applet test number is not numerous with ",(0,a.kt)("inlineCode",{parentName:"p"},"<live-pusher>")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<live-player>")," , you need to apply for the regular applet account for development.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Since native components (i.e. ",(0,a.kt)("inlineCode",{parentName:"p"},"<live-pusher>")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"<live-player>")," tags) need to run on",(0,a.kt)("strong",{parentName:"p"},"True"),"are not supported by the developer tool.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The applet pull label does not support individual applets but only business class app.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The applet pull usage permission is temporarily open to limited",(0,a.kt)("a",{parentName:"p",href:"https://developers.weixin.qq.com/miniprogram/dev/component/live-pusher.html"},"classes"),".")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Small programs that meet the category requirements need to be activated in ",(0,a.kt)("strong",{parentName:"p"},"[WeChat Public Platform]"),">",(0,a.kt)("strong",{parentName:"p"},"[Development]"),">",(0,a.kt)("strong",{parentName:"p"},"[Development Management]"),">",(0,a.kt)("strong",{parentName:"p"},"[Interface Settings]"),",",(0,a.kt)("strong",{parentName:"p"},"real-time playback of audio and video streams"),"and",(0,a.kt)("strong",{parentName:"p"},"real-time Two permissions for recording audio and video streams"),", as shown in the figure below\uff1a"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{parentName:"p",src:"https://vrlab-static.ljcdn.com/release/web/wx/check.5d997a77.png",alt:"check"})))),(0,a.kt)("h2",{id:"development-preparation"},"Development preparation"),(0,a.kt)("h3",{id:"apply-sdk-access-key"},"Apply SDK access key"),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Please apply to the developer center for access key containing ",(0,a.kt)("inlineCode",{parentName:"p"},"app_id")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"app_secret"),".")),(0,a.kt)("h3",{id:"add-widgets-valid-domain-whitelist"},"Add widget's valid domain whitelist"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Requisite valid domain name"),": ",(0,a.kt)("inlineCode",{parentName:"p"},"https://cloud.tencent.com;https://yun.tim.qq.com;https://app-gateway-realsee.ke.com;https://app-gateway.realsee.com;https://app-gateway.rushivr.com;"),".")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Legal domain name for WebSocket"),": ",(0,a.kt)("inlineCode",{parentName:"p"},"wss://ws.realsee.cn;wss://ws.realsee.com;wss://ws.rushivr.cn;wss://ws.rushivr.com;"),"."))),(0,a.kt)("h3",{id:"sdk-downloads"},"SDK Downloads"),(0,a.kt)("p",null,"Download ",(0,a.kt)("inlineCode",{parentName:"p"},"vrwebview-miniprogram.zip")," file through ",(0,a.kt)("a",{parentName:"p",href:"https://vrlab-static.ljcdn.com/release/web/vrwebview-miniprogram.69019b5f.zip"},"SDK resource")," , decompress it and use it in subsequent development."),(0,a.kt)("h3",{id:"sdk-usage"},"SDK Usage"),(0,a.kt)("p",null,"vrwebview-miniprogram provides capability access in the form of native custom components of the micromessaging app. In theory only the custom component development framework that supports the micromessenger applet can be developed and has now been tested for the inbound framework\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developers.weixin.qq.com/miniprogram/dev/framework/"},"Miniprogram original development")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://taro.jd.com/"},"Taro 3")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://uniapp.dcloud.io/"},"uni-app"))),(0,a.kt)("admonition",{title:"hint",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The following code variables are used in method",(0,a.kt)("inlineCode",{parentName:"p"},"$PROJECT"),"identify the root of the development framework.")),(0,a.kt)("h4",{id:"miniprogram-native-development-usage"},"Miniprogram native development usage"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Unpressed",(0,a.kt)("inlineCode",{parentName:"li"},"vrwebview-miniprogram.zip"),"to",(0,a.kt)("inlineCode",{parentName:"li"},"$PROJECT/lib/vrwebview"),"directories are structured around\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"-$PROJECT\n  -pages\n    -vr\n      -index.js\n      -index.json\n      -index.wxml\n      -index.wxss\n  -lib\n    -vrwebview\n      -index.d.ts\n      -index.js\n      -index.json\n      -index.wxml\n      -utils.d.ts\n      -utils.js\n      -trtc-wx.js\n      -TERMS.txt\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Assume that the page directory you want to introduce components is",(0,a.kt)("inlineCode",{parentName:"li"},"$PROJECT/pages/vr"),", the configuration json file in the page directory needs to be modified.The following is\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "usingComponents": {\n    "vr-webview": "$PROJECT/lib/vrwebview"\n  }\n}\n')),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Add component nodes to the template wxml file in the page directory.The following is\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<vr-webview\n  wx:if="{{rsVrUrl}}"\n  rsVrUrl="{{rsVrUrl}}"\n  rsVrOptions="{{rsVrOptions}}"\n  rsVrSchemes="{{rsVrSchemes}}"\n  rsVrBehaviors="{{rsVrBehaviors}}"\n>\n</vr-webview>\n')),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Initialize SDK on page js.Example after\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const { rsVrWebviewPropsWrapper } = require("$PROJECT/lib/vrwebview/utils");\nPage({\n  data: {\n    rsVrUrl: "",\n    rsVrOptions: "",\n    rsVrSchemes: "",\n    rsVrBehaviors: "",\n  },\n  onReady() {\n    this.initVr();\n  },\n  initVr() {\n    const rsVrUrl = "vr\u94fe\u63a5";\n    const rsVrOptions = rsVrWebviewPropsWrapper({\n      app: {\n        key: "app_id",\n        secret: "app_secret",\n        gateway: "\u7f51\u5173\u5730\u5740",\n        startup: "sdk\u542f\u52a8uri",\n        sign: "\u8bed\u97f3\u7b7e\u540duri",\n      },\n      info: {\n        appName: "\u5c0f\u7a0b\u5e8f\u540d",\n        appVersion: "\u5c0f\u7a0b\u5e8f\u7248\u672c",\n        scheme: "jsbridge\u8c03\u7528\u7684\u534f\u8bae\u5934",\n        userAgent: "\u7279\u6b8aUA",\n        extraData: {}, // \u5176\u5b83\u81ea\u5b9a\u4e49\u6269\u5c55\u4fe1\u606f\n      },\n      trtc: require("$PROJECT/lib/vrwebview/trtc-wx"), // \u53ef\u9009\u9879\uff0c\u9700\u8981\u5e26\u770b\u7684\u65f6\u5019\u5fc5\u586b\n    });\n\n    // \u6ce8\u2f0a\u2f83\u5b9a\u4e49scheme\uff0c\u8fd9\u2fa5\u662f\u4e0eh5\u7ea6\u5b9a\u7684\u4f7f\u2f64jsbridge-x\u8fdb\u2f8f\u901a\u4fe1\u7684\u2f45\u6cd5\n    const rsVrSchemes = rsVrWebviewPropsWrapper({\n      customFunction: (callback, params) => {\n        // \u2f83\u5b9a\u4e49\u2f45\u6cd5\uff0ch5\u4f1a\u901a\u8fc7jsbridge-x\u7684 callAndBackfeed \u6216 callAndListen \u7684\u2f45\u5f0f\u8fdb\u2f8f\u8c03\u2f64\uff08\u5177\u4f53\u8c03\u2f64\u2f45\u5f0f\u7531\u4e24\u8005\u534f\u5546\u786e\u5b9a\uff09\n        // callAndBackfeed \u662f\u2f00\u6b21\u8ba2\u9605\u6d41\uff0c\u53ef\u5f53\u2f00\u6b21\u51fd\u6570\u8c03\u2f64\uff0c\u5c06\u7ed3\u6784\u901a\u8fc7callback\u56de\u8c03\u7ed9h5\n        // callAndListen \u662f\u591a\u6b21\u8ba2\u9605\u6d41\uff0c\u4e0e\u4e8b\u4ef6\u8ba2\u9605\u7c7b\u4f3c\uff0c\u628acallback\u6ce8\u518c\u5230\u67d0\u4e8b\u4ef6\u7684\u56de\u8c03\u2fa5\uff0c\u5e76\u4e14\u5728\u2eda\u2faf\u5173\u95ed\u540e\u89e3\u9664\u6ce8\u518c\n        // \u4f8b\u5982\uff1awx.onError(callback) // \u6301\u7eed\u5411h5\u4e0a\u62a5wx\u7684\u62a5\u9519\n        // \u89e3\u9664\uff1awx.offError(callback)\n      },\n    });\n\n    // \u6ce8\u2f0aVRWebview\u7ec4\u4ef6\u6240\u9700\u7684\u2f8f\u4e3a\n    const rsVrBehaviors = rsVrWebviewPropsWrapper({\n      // \u8fdb\u2f8f\u767b\u5f55\n      requestLogin: async () => {\n        // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n        return {\n          userName: "\u2f64\u6237\u540d",\n          userId: "\u2f64\u6237ID",\n          token: "\u2f64\u6237\u4ee4\u724c",\n          avatar: "\u2f64\u6237\u5934\u50cf",\n        };\n      },\n      // \u83b7\u53d6\u2f64\u6237\u4fe1\u606f\n      getUserInfo: async () => {\n        // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n        return {\n          userName: "\u2f64\u6237\u540d",\n          userId: "\u2f64\u6237ID",\n          token: "\u2f64\u6237\u4ee4\u724c",\n          avatar: "\u2f64\u6237\u5934\u50cf",\n        };\n      },\n      // \u8fdb\u2f8f\u5206\u4eab\n      actionShare: async (params) => {\n        // h5\u4e2d\u4f1a\u6709\u5206\u4eab\u529f\u80fd\uff0cparams\u662f\u76f8\u5e94\u7684\u5206\u4eab\u914d\u7f6e\uff08\u7531h5\u4e0e\u2f29\u7a0b\u5e8f\u4e4b\u95f4\u8fdb\u2f8f\u534f\u5546\uff09\n        // \u56e0\u4e3a\u2f29\u7a0b\u5e8f\u5728webview\u4e0b\u2f46\u6cd5\u76f4\u63a5\u8c03\u8d77\u5206\u4eab\uff0c\u8fd9\u2fa5\u7684\u6700\u4f73\u5b9e\u8df5\u662f\u83b7\u53d6params\u7684\u6570\u636e\u540e\u5bf9\u2eda\u2faf\u7684shareConfig\u6570\u636e\u8fdb\u2f8f\u7f13\u5b58\uff0c\u5728\u5206\u4eab\u76f8\u5173\u7684\u94a9\u2f26\u51fd\u6570\u2fa5\u5c06\u7f13\u5b58\u7684\u6570\u636e\u8fd4\u7ed9wx\n      },\n      // \u5f53VR\u9000\u51fa\u65f6, _params\u662f\u4e0eh5\u534f\u5546\u7684\u9000\u51fa\u6d88\u606f\u7ed3\u6784\n      onExitVr: async (_params) => {\n        console.log("onExitVr", _params);\n      },\n      // \u5f53webview\u53d1\u2f63\u9519\u8bef\u65f6\u8fdb\u2f8f\u5904\u7406\n      onWebViewError: (e) => {\n        console.error("onWebViewError", e);\n      },\n      // \u7ec4\u4ef6\u62a5\u9519\u65f6\u7684\u56de\u8c03\n      onError: (e) => {\n        console.error("onError", e);\n      },\n      // \u83b7\u53d6\u2f64\u6237\u7684token\uff0c\u56e0\u4e3ah5\u4f7f\u2f64token\u65f6\u53ef\u80fd\u4f1a\u56e0token\u8d85\u65f6\u5931\u6548\uff0c\u8be5\u2f45\u6cd5\u8981\u6c42\u8fd4\u56de\u6700\u65b0\u7684\u6709\u6548token\n      getToken: async () => {\n        // return \'abc\'\n      },\n    });\n\n    // \u628a\u58f0\u660e\u597d\u7684\u53d8\u91cf\u585e\u7ed9\u7ec4\u4ef6\n    this.setData({\n      rsVrUrl,\n      rsVrOptions,\n      rsVrSchemes,\n      rsVrBehaviors,\n    });\n  },\n});\n')),(0,a.kt)("h4",{id:"taro-3-framework-access"},"Taro 3 Framework Access"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Unpacking",(0,a.kt)("inlineCode",{parentName:"li"},"vrwebview-miniprogram.zip"),"to",(0,a.kt)("inlineCode",{parentName:"li"},"$PROJECT/wxcomponents/vrwebview"),"directories around\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"-$PROJECT\n  -src\n    -pages\n      -vr\n        -index.tsx\n        -index.config.js\n    -lib\n      -vrwebview\n        -index.d.ts\n        -index.js\n        -index.json\n        -index.wxml\n        -utils.d.ts\n        -utils.js\n        -trtc-wx.js\n        -TERMS.txt\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Assume that the page directory path you want to introduce to the component is",(0,a.kt)("inlineCode",{parentName:"li"},"$PROJECT/src/pages/vr"),"then change the configuration in the page directory.The following is\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'export default {\n  usingComponents: {\n    // Define the third-party components that need to be imported\n    // 1. The key value specifies the name of the third-party component, starting with a lowercase\n    // 2. The value value specifies the relative path of the js file of the third-party component\n    "vr-webview": "../../wxcomponents/vrwebview/index",\n  },\n};\n')),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Using components on page",(0,a.kt)("inlineCode",{parentName:"li"},"index.tsx"),"as shown below\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'import React, { Component } from \'react\'\nimport { View } from \'@tarojs/components\'\nimport { rsVrWebviewPropsWrapper } from "$PROJECT/lib/vrwebview/utils"\n\nexport default class Index extends Component {\n  this.state = {\n    rsVrUrl: "",\n    rsVrOptions: "",\n    rsVrSchemes: "",\n    rsVrBehaviors: "",\n  }\n\n  onReady () {\n    this.initVr()\n  }\n\n  initVr() {\n        const rsVrUrl = "vr\u94fe\u63a5";\n    const rsVrOptions = rsVrWebviewPropsWrapper({\n      app: {\n        key: "app_id",\n        secret: "app_secret",\n        gateway: "\u7f51\u5173\u5730\u5740",\n        startup: "sdk\u542f\u52a8uri",\n        sign: "\u8bed\u97f3\u7b7e\u540duri",\n      },\n      info: {\n        appName: "\u5c0f\u7a0b\u5e8f\u540d",\n        appVersion: "\u5c0f\u7a0b\u5e8f\u7248\u672c",\n        scheme: "jsbridge\u8c03\u7528\u7684\u534f\u8bae\u5934",\n        userAgent: "\u7279\u6b8aUA",\n        extraData: {}, // \u5176\u5b83\u81ea\u5b9a\u4e49\u6269\u5c55\u4fe1\u606f\n      },\n      trtc: require("$PROJECT/lib/vrwebview/trtc-wx"), // \u53ef\u9009\u9879\uff0c\u9700\u8981\u5e26\u770b\u7684\u65f6\u5019\u5fc5\u586b\n    });\n\n    // \u6ce8\u2f0a\u2f83\u5b9a\u4e49scheme\uff0c\u8fd9\u2fa5\u662f\u4e0eh5\u7ea6\u5b9a\u7684\u4f7f\u2f64jsbridge-x\u8fdb\u2f8f\u901a\u4fe1\u7684\u2f45\u6cd5\n    const rsVrSchemes = rsVrWebviewPropsWrapper({\n      customFunction: (callback, params) => {\n        // \u2f83\u5b9a\u4e49\u2f45\u6cd5\uff0ch5\u4f1a\u901a\u8fc7jsbridge-x\u7684 callAndBackfeed \u6216 callAndListen \u7684\u2f45\u5f0f\u8fdb\u2f8f\u8c03\u2f64\uff08\u5177\u4f53\u8c03\u2f64\u2f45\u5f0f\u7531\u4e24\u8005\u534f\u5546\u786e\u5b9a\uff09\n        // callAndBackfeed \u662f\u2f00\u6b21\u8ba2\u9605\u6d41\uff0c\u53ef\u5f53\u2f00\u6b21\u51fd\u6570\u8c03\u2f64\uff0c\u5c06\u7ed3\u6784\u901a\u8fc7callback\u56de\u8c03\u7ed9h5\n        // callAndListen \u662f\u591a\u6b21\u8ba2\u9605\u6d41\uff0c\u4e0e\u4e8b\u4ef6\u8ba2\u9605\u7c7b\u4f3c\uff0c\u628acallback\u6ce8\u518c\u5230\u67d0\u4e8b\u4ef6\u7684\u56de\u8c03\u2fa5\uff0c\u5e76\u4e14\u5728\u2eda\u2faf\u5173\u95ed\u540e\u89e3\u9664\u6ce8\u518c\n        // \u4f8b\u5982\uff1awx.onError(callback) // \u6301\u7eed\u5411h5\u4e0a\u62a5wx\u7684\u62a5\u9519\n        // \u89e3\u9664\uff1awx.offError(callback)\n      },\n    });\n\n    // \u6ce8\u2f0aVRWebview\u7ec4\u4ef6\u6240\u9700\u7684\u2f8f\u4e3a\n    const rsVrBehaviors = rsVrWebviewPropsWrapper({\n      // \u8fdb\u2f8f\u767b\u5f55\n      requestLogin: async () => {\n        // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n        return {\n          userName: "\u2f64\u6237\u540d",\n          userId: "\u2f64\u6237ID",\n          token: "\u2f64\u6237\u4ee4\u724c",\n          avatar: "\u2f64\u6237\u5934\u50cf",\n        };\n      },\n      // \u83b7\u53d6\u2f64\u6237\u4fe1\u606f\n      getUserInfo: async () => {\n        // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n        return {\n          userName: "\u2f64\u6237\u540d",\n          userId: "\u2f64\u6237ID",\n          token: "\u2f64\u6237\u4ee4\u724c",\n          avatar: "\u2f64\u6237\u5934\u50cf",\n        };\n      },\n      // \u8fdb\u2f8f\u5206\u4eab\n      actionShare: async (params) => {\n        // h5\u4e2d\u4f1a\u6709\u5206\u4eab\u529f\u80fd\uff0cparams\u662f\u76f8\u5e94\u7684\u5206\u4eab\u914d\u7f6e\uff08\u7531h5\u4e0e\u2f29\u7a0b\u5e8f\u4e4b\u95f4\u8fdb\u2f8f\u534f\u5546\uff09\n        // \u56e0\u4e3a\u2f29\u7a0b\u5e8f\u5728webview\u4e0b\u2f46\u6cd5\u76f4\u63a5\u8c03\u8d77\u5206\u4eab\uff0c\u8fd9\u2fa5\u7684\u6700\u4f73\u5b9e\u8df5\u662f\u83b7\u53d6params\u7684\u6570\u636e\u540e\u5bf9\u2eda\u2faf\u7684shareConfig\u6570\u636e\u8fdb\u2f8f\u7f13\u5b58\uff0c\u5728\u5206\u4eab\u76f8\u5173\u7684\u94a9\u2f26\u51fd\u6570\u2fa5\u5c06\u7f13\u5b58\u7684\u6570\u636e\u8fd4\u7ed9wx\n      },\n      // \u5f53VR\u9000\u51fa\u65f6, _params\u662f\u4e0eh5\u534f\u5546\u7684\u9000\u51fa\u6d88\u606f\u7ed3\u6784\n      onExitVr: async (_params) => {\n        console.log("onExitVr", _params);\n      },\n      // \u5f53webview\u53d1\u2f63\u9519\u8bef\u65f6\u8fdb\u2f8f\u5904\u7406\n      onWebViewError: (e) => {\n        console.error("onWebViewError", e);\n      },\n      // \u7ec4\u4ef6\u62a5\u9519\u65f6\u7684\u56de\u8c03\n      onError: (e) => {\n        console.error("onError", e);\n      },\n      // \u83b7\u53d6\u2f64\u6237\u7684token\uff0c\u56e0\u4e3ah5\u4f7f\u2f64token\u65f6\u53ef\u80fd\u4f1a\u56e0token\u8d85\u65f6\u5931\u6548\uff0c\u8be5\u2f45\u6cd5\u8981\u6c42\u8fd4\u56de\u6700\u65b0\u7684\u6709\u6548token\n      getToken: async () => {\n        // return \'abc\'\n      },\n    });\n\n    // \u628a\u58f0\u660e\u597d\u7684\u53d8\u91cf\u585e\u7ed9\u7ec4\u4ef6\n    this.setState({\n      rsVrUrl,\n      rsVrOptions,\n      rsVrSchemes,\n      rsVrBehaviors,\n    });\n  }\n\n  render () {\n    const { rsVrUrl, rsVrOptions, rsVrSchemes, rsVrBehaviors } = this.state;\n    return (\n      <View>\n        {rsVrUrl && (\n          <vr-webview\n            rsVrUrl={rsVrUrl}\n            rsVrOptions={rsVrOptions}\n            rsVrSchemes={rsVrSchemes}\n            rsVrBehaviors={rsVrBehaviors}\n          ></vr-webview>\n        )}\n      </View>\n    );\n  }\n}\n')),(0,a.kt)("h4",{id:"uni-app-access"},"uni-app access"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"New",(0,a.kt)("inlineCode",{parentName:"li"},"wxcomponents"),"directory, will",(0,a.kt)("inlineCode",{parentName:"li"},"vrwebview-miniprogram.zip"),"extract to",(0,a.kt)("inlineCode",{parentName:"li"},"$PROJECT/wxcomponents/vrwebview"),"directories around\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"-$PROJECT\n  -src\n    -pages\n      -vr\n        -index.vue\n    -wxcomponents\n      -vrwebview\n        -index.d.ts\n        -index.js\n        -index.json\n        -index.wxml\n        -utils.d.ts\n        -utils.js\n        -trtc-wx.js\n        -TERMS.txt\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Add a declaration to the project profile",(0,a.kt)("inlineCode",{parentName:"li"},"pages.json"),"for pages that need to introduce components, eg:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pages": [\n    //The first item in the pages array indicates the application startup page, refer to\uff1ahttps://uniapp.dcloud.io/collocation/pages\n    {\n      "path": "pages/index/index",\n      "style": {\n        "usingComponents": {\n          // #ifdef APP-PLUS || MP-WEIXIN || MP-QQ\n          "vr-webview": "/wxcomponents/vrwebview/index"\n          // # endif\n        }\n      }\n    }\n  ]\n}\n')),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Use the following in vue page")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vue"},'<template>\n  <vr-webview\n    v-if="rsVrUrl"\n    :rsVrUrl="rsVrUrl"\n    :rsVrOptions="rsVrOptions"\n    :rsVrSchemes="rsVrSchemes"\n    :rsVrBehaviors="rsVrBehaviors"\n  >\n  </vr-webview>\n</template>\n\n<script>\n// \u5f53\u9700\u8981\u5e26\u770b\u65f6\u9700\u8981\u81ea\u884c\u5f15\u5165TRTC\n// import TRTC from \'../../wxcomponents/vrwebview/trtc-wx\'\n\n// \u5f15\u5165\u7ec4\u4ef6props\u6570\u636e\u8fdb\u884c\u5c01\u88c5\u7684\u5de5\u5177\u51fd\u6570\nimport { rsVrWebviewPropsWrapper } from "../../wxcomponents/vrwebview/utils.js";\n\nexport default {\n  data() {\n    return {\n      // \u7ec4\u4ef6\u4f7f\u7528\u7684\u521d\u59cb\u5316\u53c2\u6570\n      rsVrUrl: "",\n      rsVrOptions: "",\n      rsVrSchemes: "",\n      rsVrBehaviors: "",\n    };\n  },\n  onLoad() {},\n  onReady() {\n    this.initVr();\n  },\n  methods: {\n    // \u8fdb\u884cVR\u7684\u521d\u59cb\u5316\uff0c\u5728\u8fd9\u91cc\u5bf9\u7ec4\u4ef6\u7684\u53c2\u6570\u8fdb\u884c\u5904\u7406\n    initVr() {\n      // \u8fd9\u4e2a\u662fVR\u7f51\u5173\u76f8\u5173\u7684\u914d\u7f6e\n      this.rsVrOptions = rsVrWebviewPropsWrapper({\n        app: {\n          key: "app_id",\n          secret: "app_secret",\n          gateway: "\u7f51\u5173\u5730\u5740",\n          startup: "sdk\u542f\u52a8uri",\n          sign: "\u8bed\u97f3\u7b7e\u540duri",\n        },\n        info: {\n          appName: "\u5c0f\u7a0b\u5e8f\u540d",\n          appVersion: "\u5c0f\u7a0b\u5e8f\u7248\u672c",\n          scheme: "jsbridge\u8c03\u7528\u7684\u534f\u8bae\u5934",\n          userAgent: "\u7279\u6b8aUA",\n          extraData: {}, // \u5176\u5b83\u81ea\u5b9a\u4e49\u6269\u5c55\u4fe1\u606f\n        },\n        // trtc: TRTC, // \u5e26\u770b\u5f15\u5165\u7684TRTC\u5bf9\u8c61\n      });\n\n      // \u6ce8\u5165\u81ea\u5b9a\u4e49scheme\uff0c\u8fd9\u91cc\u662f\u4e0eh5\u7ea6\u5b9a\u7684\u4f7f\u7528jsbridge-x\u8fdb\u884c\u901a\u4fe1\u7684\u65b9\u6cd5\n      this.rsVrSchemes = rsVrWebviewPropsWrapper({\n        customFunction: (callback, params) => {\n          // \u81ea\u5b9a\u4e49\u65b9\u6cd5\uff0ch5\u4f1a\u901a\u8fc7jsbridge-x\u7684 callAndBackfeed \u6216 callAndListen \u7684\u65b9\u5f0f\u8fdb\u884c\u8c03\u7528\uff08\u5177\u4f53\u8c03\u7528\u65b9\u5f0f\u7531\u4e24\u8005\u534f\u5546\u786e\u5b9a\uff09\n          // callAndBackfeed \u662f\u4e00\u6b21\u8ba2\u9605\u6d41\uff0c\u53ef\u5f53\u4e00\u6b21\u51fd\u6570\u8c03\u7528\uff0c\u5c06\u7ed3\u6784\u901a\u8fc7callback\u56de\u8c03\u7ed9h5\n          // callAndListen \u662f\u591a\u6b21\u8ba2\u9605\u6d41\uff0c\u4e0e\u4e8b\u4ef6\u8ba2\u9605\u7c7b\u4f3c\uff0c\u628acallback\u6ce8\u518c\u5230\u67d0\u4e8b\u4ef6\u7684\u56de\u8c03\u91cc\uff0c\u5e76\u4e14\u5728\u9875\u9762\u5173\u95ed\u540e\u89e3\u9664\u6ce8\u518c\n          // \u4f8b\u5982\uff1awx.onError(callback) // \u6301\u7eed\u5411h5\u4e0a\u62a5wx\u7684\u62a5\u9519\n          // \u89e3\u9664\uff1awx.offError(callback)\n        },\n      });\n\n      // \u6ce8\u5165VRWebview\u7ec4\u4ef6\u6240\u9700\u7684\u884c\u4e3a\n      this.rsVrBehaviors = rsVrWebviewPropsWrapper({\n        // \u8fdb\u884c\u767b\u5f55\n        requestLogin: async () => {\n          // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n          return {\n            userName: "\u7528\u6237\u540d",\n            userId: "\u7528\u6237ID",\n            token: "\u7528\u6237\u4ee4\u724c",\n            avatar: "\u7528\u6237\u5934\u50cf",\n          };\n        },\n        // \u83b7\u53d6\u7528\u6237\u4fe1\u606f\n        getUserInfo: async () => {\n          // \u9700\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\n          return {\n            userName: "\u7528\u6237\u540d",\n            userId: "\u7528\u6237ID",\n            token: "\u7528\u6237\u4ee4\u724c",\n            avatar: "\u7528\u6237\u5934\u50cf",\n          };\n        },\n        // \u8fdb\u884c\u5206\u4eab\n        actionShare: async (params) => {\n          // h5\u4e2d\u4f1a\u6709\u5206\u4eab\u529f\u80fd\uff0cparams\u662f\u76f8\u5e94\u7684\u5206\u4eab\u914d\u7f6e\uff08\u7531h5\u4e0e\u5c0f\u7a0b\u5e8f\u4e4b\u95f4\u8fdb\u884c\u534f\u5546\uff09\n          // \u56e0\u4e3a\u5c0f\u7a0b\u5e8f\u5728webview\u4e0b\u65e0\u6cd5\u76f4\u63a5\u8c03\u8d77\u5206\u4eab\uff0c\u8fd9\u91cc\u7684\u6700\u4f73\u5b9e\u8df5\u662f\u83b7\u53d6params\u7684\u6570\u636e\u540e\u5bf9\u9875\u9762\u7684shareConfig\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff0c\u5728\u5206\u4eab\u76f8\u5173\u7684\u94a9\u5b50\u51fd\u6570\u91cc\u5c06\u7f13\u5b58\u7684\u6570\u636e\u8fd4\u7ed9wx\n        },\n        // \u5f53VR\u9000\u51fa\u65f6, _params\u662f\u4e0eh5\u534f\u5546\u7684\u9000\u51fa\u6d88\u606f\u7ed3\u6784\n        onExitVr: async (_params) => {\n          console.log("onExitVr", _params);\n        },\n        // \u5f53webview\u53d1\u751f\u9519\u8bef\u65f6\u8fdb\u884c\u5904\u7406\n        onWebViewError: (e) => {\n          console.error("onWebViewError", e);\n        },\n        // \u7ec4\u4ef6\u62a5\u9519\u65f6\u7684\u56de\u8c03\n        onError: (e) => {\n          console.error("onError", e);\n        },\n        // \u83b7\u53d6\u7528\u6237\u7684token\uff0c\u56e0\u4e3ah5\u4f7f\u7528token\u65f6\u53ef\u80fd\u4f1a\u56e0token\u8d85\u65f6\u5931\u6548\uff0c\u8be5\u65b9\u6cd5\u8981\u6c42\u8fd4\u56de\u6700\u65b0\u7684\u6709\u6548token\n        getToken: async () => {\n          // return \'abc\'\n        },\n      });\n\n      // \u8fd9\u91cc\u662f\u9700\u8981\u6253\u5f00\u7684vr\u94fe\u63a5, \u6ce8\u610f\uff0c\u4e00\u5b9a\u7b49\u4e0a\u9762\u521d\u59cb\u5316\u5b8c\u6210\u518d\u8bbe\u7f6evrUrl\uff0c\u56e0\u4e3avue\u7684\u7279\u6027\uff0c\u63d0\u524d\u8bbe\u7f6evrUrl\u4f1a\u5bfc\u81f4\u7ec4\u4ef6\u63d0\u524d\u6e32\u67d3\u62a5\u9519\u3002\n      this.rsVrUrl = ""; // Here is VRLink\n    },\n  },\n};\n<\/script>\n')))}c.isMDXComponent=!0}}]);
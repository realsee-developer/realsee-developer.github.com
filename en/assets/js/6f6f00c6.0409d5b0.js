"use strict";(self.webpackChunkrealsee_developer_github_com=self.webpackChunkrealsee_developer_github_com||[]).push([[2167],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),u=o,g=p["".concat(s,".").concat(u)]||p[u]||m[u]||r;return n?a.createElement(g,i(i({ref:t},d),{},{components:n})):a.createElement(g,i({ref:t},d))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),o=n(86010);const r={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r.tabItem,i),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(87462),o=n(67294),r=n(86010),i=n(72389),l=n(67392),s=n(7094),c=n(12466);const d={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function p(e){const{lazy:t,block:n,defaultValue:i,values:p,groupId:m,className:u}=e,g=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),h=p??g.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),f=(0,l.l)(h,((e,t)=>e.value===t.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const b=null===i?i:i??g.find((e=>e.props.default))?.props.value??g[0].props.value;if(null!==b&&!h.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${h.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:k}=(0,s.U)(),[y,w]=(0,o.useState)(b),T=[],{blockElementScrollPositionUntilNextRender:x}=(0,c.o5)();if(null!=m){const e=v[m];null!=e&&e!==y&&h.some((t=>t.value===e))&&w(e)}const N=e=>{const t=e.currentTarget,n=T.indexOf(t),a=h[n].value;a!==y&&(x(t),w(a),null!=m&&k(m,String(a)))},j=e=>{let t=null;switch(e.key){case"Enter":N(e);break;case"ArrowRight":{const n=T.indexOf(e.currentTarget)+1;t=T[n]??T[0];break}case"ArrowLeft":{const n=T.indexOf(e.currentTarget)-1;t=T[n]??T[T.length-1];break}}t?.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",d.tabList)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},u)},h.map((e=>{let{value:t,label:n,attributes:i}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,key:t,ref:e=>T.push(e),onKeyDown:j,onClick:N},i,{className:(0,r.Z)("tabs__item",d.tabItem,i?.className,{"tabs__item--active":y===t})}),n??t)}))),t?(0,o.cloneElement)(g.filter((e=>e.props.value===y))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==y})))))}function m(e){const t=(0,i.Z)();return o.createElement(p,(0,a.Z)({key:String(t)},e))}},77162:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var a=n(87462),o=(n(67294),n(3905)),r=n(65488),i=n(85162);const l={title:"Tag"},s=void 0,c={unversionedId:"front/3d-space/handbook/no-framework/tagging",id:"front/3d-space/handbook/no-framework/tagging",title:"Tag",description:"Previous chapter recalls: points in three dimensions",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/front/3d-space/handbook/no-framework/5.tagging.md",sourceDirName:"front/3d-space/handbook/no-framework",slug:"/front/3d-space/handbook/no-framework/tagging",permalink:"/en/docs/front/3d-space/handbook/no-framework/tagging",draft:!1,tags:[],version:"current",lastUpdatedBy:"sansi.lcj",lastUpdatedAt:1669717185,formattedLastUpdatedAt:"Nov 29, 2022",sidebarPosition:5,frontMatter:{title:"Tag"},sidebar:"\u4e09\u7ef4\u7a7a\u95f4",previous:{title:"Points in 3D space",permalink:"/en/docs/front/3d-space/handbook/no-framework/points-in-3d"},next:{title:"Beginning",permalink:"/en/docs/front/3d-space/handbook/react-hoc/get-started"}},d={},p=[{value:"Preparatory work",id:"preparatory-work",level:2},{value:"Developing Tag Features",id:"developing-tag-features",level:2},{value:"Add Tag Style",id:"add-tag-style",level:3},{value:"Project2d Description",id:"project2d-description",level:3},{value:"Write Logical Code",id:"write-logical-code",level:3}],m={toc:p},u="wrapper";function g(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Previous chapter recalls: points in three dimensions")," ",(0,o.kt)("br",null),"\nyou understand the Live SDK event system and try to develop a small app to get a point of three-dimensional location by clicking on the event.")),(0,o.kt)("admonition",{title:"This chapter can learn to",type:"tip"},(0,o.kt)("p",{parentName:"admonition"}," Set labels in three-dimensional space.")),(0,o.kt)("h2",{id:"preparatory-work"},"Preparatory work"),(0,o.kt)("p",null,"We create a new directory (",(0,o.kt)("inlineCode",{parentName:"p"},"src/5.tagging"),"and corresponding ",(0,o.kt)("strong",{parentName:"p"},"htm")," files and ",(0,o.kt)("strong",{parentName:"p"},"js")," or ",(0,o.kt)("strong",{parentName:"p"},"ts")," files.\nThe ",(0,o.kt)("strong",{parentName:"p"},"State")," code with the previous chapter is too onerous, and we show the base development of the contents of ",(0,o.kt)("strong",{parentName:"p"},"the three-dimensional space")," chapter from ."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="src/5.tagging/index.html"',title:'"src/5.tagging/index.html"'},'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta http-equiv="X-UA-Compatible" content="IE=edge">\n  <link rel="icon" href="data:;base64,iVBORw0KGgo=">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>points in 3d</title>\n  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">\n  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet">\n  <style>\n    html, body, #app { width: 100%; height: 100%; overflow: hidden; }\n  </style>\n</head>\n<body>\n  <div id="app"></div>\n  <! - Mode switch --\x3e\n  <nav class="navbar fixed-bottom navbar-light bg-light">\n    <div class="container-fluid justify-content-center">\n      <div class="btn-group">\n        <button class="btn btn-primary active js-Panorama">Panoramic roaming</button>\n        <button class="btn btn-primary js-Floorplan">Overview of space</button>\n      </div>\n    </div>\n  </nav>\n  <script type="module" src="./index"><\/script>\n</body>\n</html>\n')),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"JavaScript",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="src/5.tagging/index.js"',title:'"src/5.tagging/index.js"'},'import { Five, parseWork } from "@realsee/five";\n\nconst workURL = "https://vrlab-public.ljcdn.com/release/static/image/release/five/work-sample/07bdc58f413bc5494f05c7cbb5cbdce4/work.json";\n\nconst five = new Five();\n\nfive.appendTo(document.querySelector("#app"));\n\nfetch(workURL).then(res => res.json()).then((json) => {\n  const work = parseWork(json);\n  five.load(work);\n});\n\nwindow.addEventListener("resize", () => five.refresh(), false);\n\n{// === mode switching ===\n  const buttons = {\n    "Panorama": document.querySelector(".js-Panorama"),\n    "Floorplan": document.querySelector(".js-Floorplan")\n  };\n\n  for (const [modeName, element] of Object.entries(buttons)) {\n    element.addEventListener("click", () => {\n      five.setState({ mode: modeName });\n    }, false);\n  }\n\n  five.on("stateChange", state => {\n    for (const [modeName, element] of Object.entries(buttons)) {\n      if (modeName === state.mode) {\n        element.classList.add("active");\n      } else {\n        element.classList.remove("active");\n      }\n    };\n  });\n}\n\nexport {};\n'))),(0,o.kt)(i.Z,{value:"TypeScript",label:"TypeScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/5.tagging/index.ts"',title:'"src/5.tagging/index.ts"'},'import { Five, Mode, parseWork } from "@realsee/five";\n\nconst workURL = "https://vrlab-public.ljcdn.com/release/static/image/release/five/work-sample/07bdc58f413bc5494f05c7cbb5cbdce4/work.json";\n\nconst five = new Five();\n\nfive.appendTo(document.querySelector("#app")!);\n\nfetch(workURL).then(res => res.json()).then((json) => {\n  const work = parseWork(json);\n  five.load(work);\n});\n\nwindow.addEventListener("resize", () => five.refresh(), false);\n\n{// === mode switching ===\n  const buttons: Partial<Record<Mode, Element>> = {\n    "Panorama": document.querySelector(".js-Panorama")!,\n    "Floorplan": document.querySelector(".js-Floorplan")!\n  };\n\n  for (const [modeName, element] of Object.entries(buttons)) {\n    element.addEventListener("click", () => {\n      five.setState({ mode: modeName as Mode });\n    }, false);\n  }\n\n  five.on("stateChange", state => {\n    for (const [modeName, element] of Object.entries(buttons)) {\n      if (modeName === state.mode) {\n        element.classList.add("active");\n      } else {\n        element.classList.remove("active");\n      }\n    };\n  });\n}\n\nexport {};\n')))),(0,o.kt)("p",null,"Start service ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run dev"),' and jump to the current page "http://localhost:3000/src/5.tagging/index.html".'),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Please see your console. The port number will change due to your configuration and current port occupancy, please check the console output.\nIf you use another development build tool, please start the service as required by your own development build tool.")),(0,o.kt)("h2",{id:"developing-tag-features"},"Developing Tag Features"),(0,o.kt)("h3",{id:"add-tag-style"},"Add Tag Style"),(0,o.kt)("p",null,"Add a tag style to the ",(0,o.kt)("strong",{parentName:"p"},"html"),"."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Style is not necessary, it is only for better labels.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="src/5.tagging/index.html"',title:'"src/5.tagging/index.html"'},'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta http-equiv="X-UA-Compatible" content="IE=edge">\n  <link rel="icon" href="data:;base64,iVBORw0KGgo=">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>\u5c55\u793a\u7a7a\u95f4 | Displaying work</title>\n  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">\n  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet">\n  <style>\n    html, body, #app { width: 100%; height: 100%; overflow: hidden; }\n    /* highlight-start */\n    /* \u6253\u6807\u7b7e */\n    .tag { position: absolute; width: 0; height: 0; transform: translateZ(0); }\n    .tag-pannel { position: absolute; width: 100px; min-height: 20px; transform: translate(-50%, 0); left: 50%; bottom: 10px; background: #333; color: #fff; border-radius: 2px; text-align: center; line-height: 20px; padding: 8px; font-size: 14px;}\n    .tag-pannel:after { content: ""; display: block; position: absolute; width: 10px; height: 10px; left: 50%; bottom: -5px; transform: translate(-50%, 0) rotate(45deg); background: #333; pointer-events: none; }\n    /* highlight-end */\n  </style>\n</head>\n<body>\n  <div id="app"></div>\n  \x3c!-- \u6a21\u5f0f\u5207\u6362 --\x3e\n  <nav class="navbar fixed-bottom navbar-light bg-light">\n    <div class="container-fluid justify-content-center">\n      <div class="btn-group">\n        <button class="btn btn-primary active js-Panorama">Panorama roaming</button>\n        <button class="btn btn-primary js-Floorplan">Space overview</button>\n      </div>\n    </div>\n  </nav>\n  \x3c!-- highlight-start --\x3e\n  \x3c!-- \u6253\u6807\u7b7e --\x3e\n  <div class="card position-fixed m-2 top-0 start-0">\n    <button class="btn btn-primary js-add-tag">\u6253\u6807\u7b7e</button>\n  </div>\n  \x3c!-- highlight-end --\x3e\n  <script type="module" src="./index"><\/script>\n</body>\n</html>\n')),(0,o.kt)("h3",{id:"project2d-description"},"Project2d Description"),(0,o.kt)("p",null,"This chapter will use the method to ",(0,o.kt)("a",{parentName:"p",href:"https://unpkg.com/@realsee/five/docs/classes/five.Five.html#project2d"},(0,o.kt)("inlineCode",{parentName:"a"},"project2")),".He can match the three-dimensional coordinates to the screen."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"five.project2d (vector: THREE.Vector3, testModel: boolean): THREE.Vector2 | null")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Incoming a three-dimensional coordinates to get a 2D coordinates of the screen, starting at the top of the left in pixels.Can be used as ",(0,o.kt)("inlineCode",{parentName:"li"},'{ left: returnValue.x + "px", top: returnValue.y + "px" }')," etc."),(0,o.kt)("li",{parentName:"ol"},"If three-dimensional coordinates cannot be calculated in the screen (e.g. behind or blocked), then return ",(0,o.kt)("inlineCode",{parentName:"li"},"null"),"."),(0,o.kt)("li",{parentName:"ol"},"The second parameter ",(0,o.kt)("strong",{parentName:"li"},"testModel")," is calculated if the model collided, i.e. if the coordinate blocked by the model is ",(0,o.kt)("inlineCode",{parentName:"li"},"null"),".")),(0,o.kt)("h3",{id:"write-logical-code"},"Write Logical Code"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"newTag")," is a tag in a new state that needs to follow the cursor position schedule."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Tags")," have fixed labels to follow the camera."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"tagToElement")," Store tag corresponding DOM structure."),(0,o.kt)("li",{parentName:"ol"},"Camera movement triggers ",(0,o.kt)("inlineCode",{parentName:"li"},"CameraUpdate")," Events, in callback functions, call by tabs ",(0,o.kt)("inlineCode",{parentName:"li"},"$five.project2")," method to get screen canvasses and then render them by changing styles.")),(0,o.kt)("p",null,"Add\uff1aafter the code of ",(0,o.kt)("strong",{parentName:"p"},"mode switch")),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"JavaScript",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="src/5.tagging/index.js"',title:'"src/5.tagging/index.js"'},'{ // === \u6253\u6807\u7b7e ===\n  const app = document.querySelector("#app");\n  const addButton = document.querySelector("). s-add-tag");\n  let newTag = null;\n  let tags = [];\n  const tagToElement = new WeakMap();\n\n  const createTagElement = tag ==> Google\n    const div = document. createElement("div");\n    div.className = "tag";\n    div.style.display = "none";\n    div.innerHTML = `<div class="tag-pannel"><span class="tag-content">${tag.label}</span></div>`;\n    app. ppendChild(div);\n    return div;\n  };\n\n  const renderTags = () => FREE\n    for (const tag of [newTag, ... ags]) {\n      if (!tag) continue;\n      if (!tag. osition) continue;\n      const element = tagToElement. et(tag);\n      if (!element) continue;\n      const position = five. roject2d(tag.position, true);\n      if (position === null) {\n        element. tyle.display = "none";\n      } else {\n        element.style. isplay = "";\n        element.style. eft = position.x + "px";\n        element. tyle.top = position. + "px";\n      }\n    }\n  };\n\n  addButton. ddEventListener("click", () => File\n    newTag = 56 label: window.prompt("Add Label", "") || "Unnamed" };\n    tagToElement. et(newtag, createTagElement(newTag));\n  }, false);\n\n  five. n("intersectionOnModelUpdate", intersect => {\n    if (newTag) newTag. Position = intersect.point;\n    renderTags();\n  });\n  five. n("wantsTapGesture", () => {\n    if (newTag && newTag.position) {\n      tags. ush(newTag);\n      newTag = null;\n      renderTags();\n      return false;\n    }\n  });\n  five. n("cameraUpdate", renderTags);\n}\n'))),(0,o.kt)(i.Z,{value:"TypeScript",label:"TypeScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/5.tagging/index.ts"',title:'"src/5.tagging/index.ts"'},'{ // === tag === \n  type Tag = { position?: THREE.Vector3, label: string };\n  const app = document.querySelector("#app")!;\n  const addButton = document.querySelector(".js-add-tag")!;\n  let newTag: Tag | null = null;\n  let tags: Tag[] = [];\n  const tagToElement = new WeakMap<Tag, HTMLElement>();\n\n  const createTagElement = (tag: Tag) => {\n    const div = document.createElement("div");\n    div.className = "tag";\n    div.style.display = "none";\n    div.innerHTML = `<div class="tag-pannel"><span class="tag-content">${tag.label}</span></div>`;\n    app.appendChild(div);\n    return div;\n  };\n\n  const renderTags = () => {\n    for (const tag of [newTag, ...tags]) {\n      if (!tag) continue;\n      if (!tag.position) continue;\n      const element = tagToElement.get(tag);\n      if (!element) continue;\n      const position = five.project2d(tag.position, true);\n      if (position === null) {\n        element.style.display = "none";\n      } else {\n        element.style.display = "";\n        element.style.left = position.x + "px";\n        element.style.top = position.y + "px";\n      }\n    }\n  };\n\n  addButton.addEventListener("click", () => {\n    newTag = { label: window.prompt("Add Label", "") || "Unnamed" };\n    tagToElement.set(newTag, createTagElement(newTag));\n  }, false);\n\n  five.on("intersectionOnModelUpdate", intersect => {\n    if (newTag) newTag.position = intersect.point;\n    renderTags();\n  });\n  five.on("wantsTapGesture", () => {\n    if (newTag && newTag.position) {\n      tags.push(newTag);\n      newTag = null;\n      renderTags();\n      return false;\n    }\n  });\n  five.on("cameraUpdate", renderTags);\n}\n')))),(0,o.kt)("p",null,"Back to your browser to view it, you will find a tabs button in the upper left corner of your page, click on, fill in the tag name, then move the mouse and click in the position you need.Tag can be placed."),(0,o.kt)("p",null,"Well, it is a functional feature: partying_face:"))}g.isMDXComponent=!0}}]);